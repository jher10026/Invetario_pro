<!-- ===================================
     DASHBOARD SIN CHART.JS
     Archivo: src/app/components/dashboard/dashboard.component.html
     =================================== -->

<div class="dashboard-container">
  <!-- Header -->
  <div class="content-header">
    <h1>Dashboard</h1>
    <div class="user-avatar">{{ iniciales }}</div>
  </div>

  <!-- Mensaje de bienvenida -->
  <div class="welcome-message">
    <h2>¬°Bienvenido, {{ usuarioActual?.name }}!</h2>
    <p>Rol: <span class="role-badge">{{ usuarioActual?.role }}</span></p>
  </div>

  <!-- Estad√≠sticas -->
  <div class="stats-grid">
    <div *ngFor="let stat of estadisticas()" class="stat-card">
      <div class="stat-info">
        <h3>{{ stat.titulo }}</h3>
        <div class="stat-value">{{ stat.valor }}</div>
      </div>
      <div [ngClass]="['stat-icon', obtenerClaseColor(stat.color)]">
        {{ stat.icono }}
      </div>
    </div>
  </div>

  <!-- Gr√°ficas -->
<!-- Gr√°ficas con Chart.js -->
  <div class="charts-grid" *ngIf="productos().length > 0; else sinProductos">
    <!-- Gr√°fica de barras -->
    <div class="chart-card">
      <h2>üìä Distribuci√≥n por Categor√≠a</h2>
      <div class="chart-content">
        <div class="chart-container">
          <canvas #chartCategorias></canvas>
        </div>
      </div>
    </div>

    <!-- Gr√°fica circular -->
    <div class="chart-card">
      <h2>üíµ Valor Total por Categor√≠a</h2>
      <div class="chart-content">
        <div class="chart-container">
          <canvas #chartCircular></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Segunda fila de gr√°ficas -->
  <div class="charts-grid" *ngIf="productos().length > 0">
    <!-- Valor por categor√≠a -->
    <div class="chart-card">
      <h2>üíµ Valor Total por Categor√≠a</h2>
      <div class="chart-content">
        <div *ngIf="datosValorCategoria().length > 0; else sinDatos3" class="bars-chart">
          <div *ngFor="let dato of datosValorCategoria()" class="chart-bar">
            <div class="bar-label">{{ dato.nombre }}</div>
            <div class="bar-container">
              <div 
                class="bar" 
                [style.width.%]="dato.porcentaje"
                [style.background]="dato.color"
              ></div>
            </div>
            <div class="bar-value">S/ {{ dato.valor.toLocaleString('es-PE', {minimumFractionDigits: 2}) }}</div>
          </div>
        </div>
        <ng-template #sinDatos3>
          <p class="no-data">Sin datos</p>
        </ng-template>
      </div>
    </div>

    <!-- Productos recientes -->
    <div class="section-card">
      <h2>üì¶ √öltimos Productos</h2>
      <div *ngIf="productos().length > 0; else sinProductosRecientes" class="products-preview">
        <div *ngFor="let producto of productos().slice(0, 5)" class="product-item">
          <div class="product-info">
            <h4>{{ producto.nombre }}</h4>
            <p>{{ producto.categoria }}</p>
          </div>
          <div class="product-details">
            <span class="price">S/ {{ producto.precio.toFixed(2) }}</span>
            <span class="stock">Stock: {{ producto.stock }}</span>
          </div>
        </div>
      </div>
      <ng-template #sinProductosRecientes>
        <div class="placeholder">
          <p>No hay productos a√∫n</p>
        </div>
      </ng-template>
    </div>
  </div>

  <!-- Sin productos -->
  <ng-template #sinProductos>
    <div class="charts-grid">
      <div class="chart-card placeholder-large">
        <p>üìä Crea productos para ver las gr√°ficas</p>
      </div>
    </div>
  </ng-template>

  <!-- Stock bajo -->
  <div class="alert-card" *ngIf="obtenerStockBajo().length > 0">
    <h2>‚ö†Ô∏è Productos con Stock Bajo</h2>
    <div class="alerts-list">
      <div *ngFor="let producto of obtenerStockBajo()" class="alert-item">
        <span class="alert-name">{{ producto.nombre }}</span>
        <span class="alert-stock">Stock: {{ producto.stock }}</span>
      </div>
    </div>
  </div>

  <!-- Categor√≠as -->
  <div class="section-card" *ngIf="categorias().length > 0">
    <h2>üè∑Ô∏è Categor√≠as</h2>
    <div class="categories-preview">
      <div *ngFor="let cat of categorias()" class="category-item">
        <div class="category-dot" [style.background]="cat.color"></div>
        <span>{{ cat.nombre }}</span>
      </div>
    </div>
  </div>
</div>